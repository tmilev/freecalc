\begin{frame}
\vskip -0.15cm
\begin{emptyTheorem}[Generalized Digital Signature Algorithm: generate public key]
\begin{itemize}

\item Given: cyclic group $\mathcal G$ of prime order $p=|\mathcal G|$, generator $g\in \mathcal G$.
\item Choose at random the private key $\mathrm{secret} \in \left\{0,1,\dots, p-1 \right\}$.
\item Compute the public key $\mathrm{pub} = g^{\mathrm{secret}}$.
\end{itemize}
\end{emptyTheorem}
\vskip -0.15cm


\vskip -0.15cm
\begin{emptyTheorem}[Generalized DSA: sign message]
\begin{enumerate}
\item Given: a number $\mathrm{digest}$ (message digest). 
\item Given: function $\mathrm{toNumber}:\mathcal G\to \mathbb Z$.
\item Choose at random $\mathrm{nonce} \in \left\{0,\dots, p-1\right\}$.
\item Compute $\mathrm{challenge} = \mathrm{toNumber} (g^{\mathrm{nonce}}) \mod p $.
\item Compute $\mathrm{solution} = \frac{\mathrm{digest} + \mathrm{challenge}\cdot \mathrm{secret}}{\mathrm{nonce}} \mod p$.
\item $(\mathrm{challenge}, \mathrm{solution})$ - final signature. 
\end{enumerate}
\end{emptyTheorem}
\vskip -0.2cm
\begin{itemize}
\item Public key $\mathrm{pub}$ - element of $\mathcal G$ but secret key $\mathrm{secret}$ is a number! 
\item Usually: $\mathrm{digest}= H(M)$, where $H$ - hash f-n, $M$ - message to sign. 
\item $M$ and $\textrm{pub}$ are not part of the signature.
\item Signature often denoted by $(r,s)$: $r= \mathrm{challenge}, s= \mathrm{solution}$.
\end{itemize}
\end{frame}

\begin{frame}
\vskip -0.15cm
\begin{emptyTheorem}[Generalized DSA: signing, key generation summary]
\begin{itemize}
\item Private key: $\mathrm{secret}$. Public key: $\mathrm{pub} = g^{\mathrm{secret}}$, $g$- generator of $\mathcal G$. 
\item $\mathrm{nonce} \in \left\{0,\dots, p-1\right\}$ - secret random use-once num.; $p=|\mathcal G|$.
\item $\mathrm{challenge} = \mathrm{toNumber}\left(g^{\mathrm{nonce}}\right)$,  $\mathrm{solution} = \frac{\mathrm{digest} + \mathrm{challenge}\cdot \mathrm{secret}}{\mathrm{nonce}} \mod p$.
\item $(\mathrm{challenge},\mathrm{solution})$ - final signature.
\end{itemize}
\end{emptyTheorem}
\vskip -0.15cm
\begin{emptyTheorem}[Generalized DSA: verify signature]
\vskip -0.15cm
\begin{enumerate}
\item $a = \frac{1}{\mathrm{solution}} \stackrel{?}{=} \frac{1}{\frac{\mathrm{digest} + \mathrm{challenge}\cdot \mathrm{secret}}{\mathrm{nonce}}} = \frac{\mathrm{nonce}}{\mathrm{digest}+ \mathrm{challenge}\cdot \mathrm{secret}} \mod p$.
\item $u_1 = a\cdot \mathrm{digest}\stackrel{?}{=}  \frac{\mathrm{nonce}\cdot \mathrm{digest} }{\mathrm{digest} + \mathrm{challenge}\cdot \mathrm{secret}} \mod p$.
\item $u_2 = a \cdot \mathrm{challenge} \stackrel{?}{=}  \frac{ \mathrm{nonce} \cdot \mathrm{challenge} }{\mathrm{digest} + \mathrm{challenge}\cdot \mathrm{secret}} \mod p$.
\item $
\begin{array}{r@{~}c@{~}l}
X &=&g^{u_1} \mathrm{pub}^{u_2} \stackrel{?}{=}  g^{\frac{ \mathrm{nonce}\cdot \mathrm{digest} }{\mathrm{digest}+ \mathrm{challenge} \cdot \mathrm{secret}}} \cdot \left(g^{\mathrm{secret}} \right)^{ \frac{ \mathrm{nonce}\cdot \mathrm{challenge} }{\mathrm{digest} + \mathrm{challenge} \cdot \mathrm{secret}}} \\
&=& g^{\frac{\mathrm{nonce}\cdot \mathrm{digest}}{\mathrm{digest}+ \mathrm{challenge} \cdot \mathrm{secret}} +  \frac{\mathrm{nonce}\cdot \mathrm{secret}\cdot \mathrm{challenge} }{\mathrm{digest} + \mathrm{challenge} \cdot \mathrm{secret}}} = g^{\frac{\mathrm{nonce}\cdot(\mathrm{digest} + \mathrm{challenge} \cdot \mathrm{nonce}) }{\mathrm{digest} +  \mathrm{challenge} \cdot \mathrm{secret}}} = g^{\mathrm{nonce}}
\end{array}
$
\item If $\mathrm{toNumber} \left(X\right) = \mathrm{challenge}$: signature is valid (invalid otherwise).
\end{enumerate}
\end{emptyTheorem}
\vskip -0.15cm
\begin{itemize}
\item If $\mathrm{nonce}$ is revealed $\mathrm{secret}$ can be computed.
\end{itemize}
\end{frame}